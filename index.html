<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Digital Compass, Age & Weather</title>
  <style>
    :root {
      --bg: #0f172a;
      --primary: #facc15;
      --secondary: #1e40af;
      --text: #f1f5f9;
      --card: #1e293b;
      --shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      color: var(--text);
      min-height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 360px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }
    h1 {
      font-size: 28px;
      color: var(--primary);
      margin-bottom: 5px;
      text-shadow: 0 0 6px #facc15aa;
    }
    .subtitle {
      color: #94a3b8;
      font-size: 14px;
    }
    .compass-container {
      width: 280px;
      height: 280px;
      position: relative;
      background: radial-gradient(circle, #1e293b 60%, #0f172a 100%);
      border-radius: 50%;
      box-shadow: inset 0 0 30px #000, 0 0 20px #1e40af80;
      border: 6px solid var(--primary);
    }
    .compass-rose {
      width: 100%;
      height: 100%;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50" y="20" text-anchor="middle" font-size="10" fill="%23facc15" font-weight="bold">N</text><text x="80" y="53" text-anchor="middle" font-size="9" fill="white">E</text><text x="50" y="85" text-anchor="middle" font-size="9" fill="white">S</text><text x="20" y="53" text-anchor="middle" font-size="9" fill="white">W</text></svg>');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      transition: transform 0.2s ease-out;
      position: absolute;
      top: 0;
      left: 0;
    }
    .compass-center {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 14px;
      height: 14px;
      background-color: var(--primary);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 8px var(--primary);
      z-index: 2;
    }
    .info-panel {
      background-color: var(--card);
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow);
      width: 100%;
    }
    .direction {
      font-size: 22px;
      font-weight: 700;
      color: var(--primary);
      margin: 10px 0;
    }
    .details {
      display: flex;
      justify-content: space-around;
      margin-top: 10px;
    }
    .detail-box {
      text-align: center;
    }
    .detail-value {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
    }
    .detail-label {
      font-size: 12px;
      color: #cbd5e1;
    }
    .message {
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
      display: none;
    }
    .instruction {
      background-color: #1e40af33;
      color: var(--primary);
      font-weight: bold;
    }
    .error {
      background-color: #dc2626;
      color: #fff;
    }
    .permission-btn {
      background-color: var(--primary);
      color: #0f172a;
      font-weight: bold;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: none;
      box-shadow: 0 0 10px #facc15aa;
    }
    .age-calculator {
      background-color: var(--card);
      padding: 16px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      width: 100%;
    }
    .age-result {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary);
      margin-top: 15px;
    }
    .weather-info {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-top: 20px;
    }
    .weather-info span {
      font-size: 14px;
      color: #cbd5e1;
    }
    input, button {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Digital Compass, Age & Weather</h1>
    <p class="subtitle">Follow your direction, calculate your age, and check the weather!</p>

    <!-- Compass -->
    <div class="compass-container">
      <div class="compass-rose" id="compassRose"></div>
      <div class="compass-center"></div>
    </div>
    <div class="info-panel">
      <div>You are facing:</div>
      <div class="direction" id="direction">--</div>
      <div class="details">
        <div class="detail-box">
          <div class="detail-value" id="degrees">0°</div>
          <div class="detail-label">Angle</div>
        </div>
        <div class="detail-box">
          <div class="detail-value" id="accuracy">--°</div>
          <div class="detail-label">Accuracy</div>
        </div>
      </div>
    </div>
    <div class="message instruction" id="instructions">Move your phone in a figure-8 to calibrate.</div>
    <button class="permission-btn" id="permissionBtn">Enable Compass</button>
    <div class="message error" id="error">Compass not available. Try using a mobile device.</div>

    <!-- Age Calculator -->
    <div class="age-calculator">
      <h3>Age Calculator</h3>
      <input type="date" id="dob" />
      <button id="calculateAge">Calculate Age</button>
      <div class="age-result" id="ageResult">Your age will appear here.</div>
    </div>

    <!-- Weather Info -->
    <div class="weather-info" id="weatherInfo">Loading weather...</div>
  </div>

  <script>
    // Age calculator
    document.getElementById("calculateAge").addEventListener("click", function() {
      const dob = document.getElementById("dob").value;
      if (dob) {
        const birthDate = new Date(dob);
        const today = new Date();

        let years = today.getFullYear() - birthDate.getFullYear();
        let months = today.getMonth() - birthDate.getMonth();
        let days = today.getDate() - birthDate.getDate();
        if (days < 0) {
          months--;
          days += 30;
        }
        if (months < 0) {
          years--;
          months += 12;
        }

        const result = `${years} years, ${months} months, ${days} days`;
        document.getElementById("ageResult").textContent = `Your age: ${result}`;
      } else {
        alert("Please select a valid date of birth.");
      }
    });

    // Weather API using WeatherAPI.com
    function fetchWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
          const apiKey = "fd5e477b95e04d7cbf665739250705"; // Demo key
          const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${lat},${lon}&aqi=no`;

          fetch(url)
            .then(response => response.json())
            .then(data => {
              const location = data.location.name + ", " + data.location.region;
              const temp = data.current.temp_c;
              const condition = data.current.condition.text;
              const icon = data.current.condition.icon;
              document.getElementById("weatherInfo").innerHTML = `
                <div>Weather in ${location}: ${temp}°C, ${condition}</div>
                <img src="https:${icon}" alt="${condition}" />
              `;
            })
            .catch(() => {
              document.getElementById("weatherInfo").textContent = "Weather data not available.";
            });
        });
      } else {
        document.getElementById("weatherInfo").textContent = "Geolocation is not supported.";
      }
    }
    window.onload = fetchWeather;
  </script>
</body>
</html>
